<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="shortcut icon" href="../Images/favicon.png" type="image/x-icon">
  <title>Daily Progress Tracker</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
    }

    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 30px;
    }

    h1 {
      color: white;
      font-size: 2.5rem;
      text-shadow: 0 2px 4px rgba(0,0,0,0.3);
    }

    .back-btn {
      background: rgba(255, 255, 255, 0.2);
      color: white;
      border: 2px solid rgba(255, 255, 255, 0.3);
      padding: 10px 20px;
      border-radius: 12px;
      text-decoration: none;
      font-weight: 600;
      transition: all 0.3s ease;
    }

    .back-btn:hover {
      background: rgba(255, 255, 255, 0.3);
      border-color: rgba(255, 255, 255, 0.5);
      transform: translateY(-2px);
    }

    .quick-stats {
      background: rgba(255, 255, 255, 0.1);
      border-radius: 15px;
      padding: 15px;
      margin-bottom: 20px;
      color: white;
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
      gap: 15px;
    }

    .quick-stat {
      text-align: center;
    }

    .quick-stat-value {
      font-size: 1.5rem;
      font-weight: 700;
      margin-bottom: 5px;
    }

    .quick-stat-label {
      font-size: 0.8rem;
      opacity: 0.8;
    }

    .main-content {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 30px;
      margin-bottom: 30px;
    }

    .card {
      background: rgba(255, 255, 255, 0.95);
      border-radius: 20px;
      padding: 30px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.2);
      backdrop-filter: blur(10px);
    }

    .form-card h2, .history-card h2 {
      color: #4a5568;
      margin-bottom: 25px;
      font-size: 1.5rem;
      text-align: center;
    }

    .form-group {
      margin-bottom: 20px;
    }

    label {
      display: block;
      margin-bottom: 8px;
      color: #2d3748;
      font-weight: 600;
      font-size: 0.9rem;
    }

    input[type="date"],
    input[type="number"],
    input[type="text"] {
      width: 100%;
      padding: 12px 16px;
      border: 2px solid #e2e8f0;
      border-radius: 12px;
      font-size: 16px;
      transition: all 0.3s ease;
      background: #f8fafc;
    }

    input:focus {
      outline: none;
      border-color: #667eea;
      background: white;
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
    }

    .submit-btn {
      width: 100%;
      padding: 15px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      border-radius: 12px;
      font-size: 1.1rem;
      font-weight: 600;
      cursor: pointer;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
      margin-top: 10px;
    }

    .submit-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
    }

    .submit-btn:active {
      transform: translateY(0);
    }

    .history-card {
      max-height: 500px;
      overflow-y: auto;
    }

    .entry {
      background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
      border-radius: 12px;
      padding: 15px;
      margin-bottom: 15px;
      border-left: 4px solid #667eea;
      transition: transform 0.2s ease;
    }

    .entry:hover {
      transform: translateX(5px);
    }

    .entry-date {
      font-weight: 700;
      color: #2d3748;
      font-size: 1.1rem;
      margin-bottom: 8px;
    }

    .entry-details {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      margin-bottom: 8px;
    }

    .entry-stat {
      background: white;
      padding: 8px 12px;
      border-radius: 8px;
      text-align: center;
      border: 1px solid #e2e8f0;
    }

    .entry-stat-value {
      font-weight: 700;
      font-size: 1.2rem;
      color: #667eea;
    }

    .entry-stat-label {
      font-size: 0.8rem;
      color: #718096;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .entry-notes {
      color: #4a5568;
      font-style: italic;
      background: white;
      padding: 10px;
      border-radius: 8px;
      margin-top: 8px;
    }

    .summary-section {
      grid-column: 1 / -1;
    }

    .summary-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
    }

    .summary-card {
      background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
      color: white;
      padding: 20px;
      border-radius: 15px;
      text-align: center;
      box-shadow: 0 5px 15px rgba(79, 172, 254, 0.3);
    }

    .summary-value {
      font-size: 2rem;
      font-weight: 700;
      margin-bottom: 5px;
    }

    .summary-label {
      font-size: 0.9rem;
      opacity: 0.9;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .empty-state {
      text-align: center;
      color: #718096;
      padding: 40px;
      font-style: italic;
    }

    .delete-btn {
      background: #e53e3e;
      color: white;
      border: none;
      padding: 5px 10px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 0.8rem;
      float: right;
      transition: background-color 0.2s ease;
    }

    .delete-btn:hover {
      background: #c53030;
    }

    @media (max-width: 768px) {
      .main-content {
        grid-template-columns: 1fr;
      }
      
      .card {
        padding: 20px;
      }
      
      h1 {
        font-size: 2rem;
      }

      .header {
        flex-direction: column;
        gap: 15px;
        text-align: center;
      }
    }

    /* Custom scrollbar */
    .history-card::-webkit-scrollbar {
      width: 8px;
    }

    .history-card::-webkit-scrollbar-track {
      background: #f1f1f1;
      border-radius: 10px;
    }

    .history-card::-webkit-scrollbar-thumb {
      background: #667eea;
      border-radius: 10px;
    }

    .history-card::-webkit-scrollbar-thumb:hover {
      background: #5a67d8;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>Daily Progress Tracker</h1>
      <a href="habit_tracker_base.html" class="back-btn">← Back to Habit Tracker</a>
    </div>

    <!-- Quick Stats -->
    <div class="quick-stats">
      <div class="quick-stat">
        <div class="quick-stat-value" id="totalEntries">0</div>
        <div class="quick-stat-label">Total Entries</div>
      </div>
      <div class="quick-stat">
        <div class="quick-stat-value" id="currentStreak">0</div>
        <div class="quick-stat-label">Day Streak</div>
      </div>
      <div class="quick-stat">
        <div class="quick-stat-value" id="thisWeekTasks">0</div>
        <div class="quick-stat-label">Tasks This Week</div>
      </div>
      <div class="quick-stat">
        <div class="quick-stat-value" id="thisWeekHours">0</div>
        <div class="quick-stat-label">Hours This Week</div>
      </div>
    </div>

    <div class="main-content">
      <!-- Form Section -->
      <div class="card form-card">
        <h2>Add Today's Progress</h2>
        <form id="progressForm">
          <div class="form-group">
            <label for="date">Date</label>
            <input type="date" id="date" required>
          </div>
          
          <div class="form-group">
            <label for="tasks">Tasks Completed</label>
            <input type="number" id="tasks" min="0" required placeholder="0">
          </div>
          
          <div class="form-group">
            <label for="hours">Hours Studied</label>
            <input type="number" id="hours" min="0" step="0.5" required placeholder="0">
          </div>
          
          <div class="form-group">
            <label for="notes">Notes</label>
            <input type="text" id="notes" placeholder="How did today go?">
          </div>
          
          <button type="submit" class="submit-btn">Save Progress</button>
        </form>
      </div>

      <!-- History Section -->
      <div class="card history-card">
        <h2>Recent Entries</h2>
        <div id="dailyHistory">
          <div class="empty-state">No entries yet. Add your first entry!</div>
        </div>
      </div>
    </div>

    <!-- Weekly Summary -->
    <div class="card summary-section">
      <h2>Weekly Summary</h2>
      <div class="summary-grid" id="weeklySummary">
        <div class="summary-card">
          <div class="summary-value" id="totalTasks">0</div>
          <div class="summary-label">Total Tasks</div>
        </div>
        <div class="summary-card">
          <div class="summary-value" id="totalHours">0</div>
          <div class="summary-label">Total Hours</div>
        </div>
        <div class="summary-card">
          <div class="summary-value" id="avgTasks">0</div>
          <div class="summary-label">Avg Tasks/Day</div>
        </div>
        <div class="summary-card">
          <div class="summary-value" id="avgHours">0</div>
          <div class="summary-label">Avg Hours/Day</div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // localStorage key for storing progress data
    const STORAGE_KEY = 'dailyProgressData';
    let progressData = [];

    // Load data from localStorage when page loads
    function loadData() {
      try {
        const storedData = localStorage.getItem(STORAGE_KEY);
        if (storedData) {
          progressData = JSON.parse(storedData);
          console.log('Loaded progress data:', progressData.length, 'entries');
        }
      } catch (error) {
        console.error('Error loading data from localStorage:', error);
        progressData = [];
      }
    }

    // Save data to localStorage
    function saveData() {
      try {
        localStorage.setItem(STORAGE_KEY, JSON.stringify(progressData));
        console.log('Data saved to localStorage');
      } catch (error) {
        console.error('Error saving data to localStorage:', error);
      }
    }

    // Initialize page
    function init() {
      loadData();
      // Set today's date by default
      document.getElementById('date').valueAsDate = new Date();
      updateDisplay();
      updateQuickStats();
    }

    // Form submission handler
    document.getElementById('progressForm').addEventListener('submit', function(e) {
      e.preventDefault();
      
      const date = document.getElementById('date').value;
      const tasks = parseInt(document.getElementById('tasks').value);
      const hours = parseFloat(document.getElementById('hours').value);
      const notes = document.getElementById('notes').value;

      // Check if entry already exists for this date
      const existingIndex = progressData.findIndex(entry => entry.date === date);
      
      const newEntry = { 
        date, 
        tasks, 
        hours, 
        notes,
        timestamp: new Date().getTime() // Add timestamp for sorting
      };
      
      if (existingIndex !== -1) {
        progressData[existingIndex] = newEntry;
      } else {
        progressData.push(newEntry);
      }

      // Sort by date (newest first)
      progressData.sort((a, b) => new Date(b.date) - new Date(a.date));

      // Save to localStorage
      saveData();

      updateDisplay();
      updateQuickStats();
      
      // Reset form
      document.getElementById('progressForm').reset();
      document.getElementById('date').valueAsDate = new Date();
      
      // Show success feedback
      showSuccessMessage();
    });

    function showSuccessMessage() {
      const btn = document.querySelector('.submit-btn');
      const originalText = btn.textContent;
      btn.textContent = 'Saved!';
      btn.style.background = '#48bb78';
      setTimeout(() => {
        btn.textContent = originalText;
        btn.style.background = '';
      }, 1500);
    }

    function deleteEntry(date) {
      if (confirm('Are you sure you want to delete this entry?')) {
        progressData = progressData.filter(entry => entry.date !== date);
        saveData(); // Save after deletion
        updateDisplay();
        updateQuickStats();
      }
    }

    function updateDisplay() {
      updateDailyHistory();
      updateWeeklySummary();
    }

    function updateDailyHistory() {
      const historyDiv = document.getElementById('dailyHistory');
      
      if (progressData.length === 0) {
        historyDiv.innerHTML = '<div class="empty-state">No entries yet. Add your first entry!</div>';
        return;
      }

      historyDiv.innerHTML = progressData.slice(0, 10).map(entry => `
        <div class="entry">
          <button class="delete-btn" onclick="deleteEntry('${entry.date}')" title="Delete entry">×</button>
          <div class="entry-date">${formatDate(entry.date)}</div>
          <div class="entry-details">
            <div class="entry-stat">
              <div class="entry-stat-value">${entry.tasks}</div>
              <div class="entry-stat-label">Tasks</div>
            </div>
            <div class="entry-stat">
              <div class="entry-stat-value">${entry.hours}</div>
              <div class="entry-stat-label">Hours</div>
            </div>
          </div>
          ${entry.notes ? `<div class="entry-notes">"${entry.notes}"</div>` : ''}
        </div>
      `).join('');
    }

    function updateWeeklySummary() {
      const now = new Date();
      const weekAgo = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);
      
      const weeklyData = progressData.filter(entry => {
        const entryDate = new Date(entry.date);
        return entryDate >= weekAgo && entryDate <= now;
      });

      const totalTasks = weeklyData.reduce((sum, entry) => sum + entry.tasks, 0);
      const totalHours = weeklyData.reduce((sum, entry) => sum + entry.hours, 0);
      const avgTasks = weeklyData.length > 0 ? (totalTasks / weeklyData.length).toFixed(1) : 0;
      const avgHours = weeklyData.length > 0 ? (totalHours / weeklyData.length).toFixed(1) : 0;

      document.getElementById('totalTasks').textContent = totalTasks;
      document.getElementById('totalHours').textContent = totalHours;
      document.getElementById('avgTasks').textContent = avgTasks;
      document.getElementById('avgHours').textContent = avgHours;
    }

    function updateQuickStats() {
      const now = new Date();
      const weekAgo = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);
      
      // Total entries
      document.getElementById('totalEntries').textContent = progressData.length;
      
      // Weekly data
      const weeklyData = progressData.filter(entry => {
        const entryDate = new Date(entry.date);
        return entryDate >= weekAgo && entryDate <= now;
      });
      
      const weeklyTasks = weeklyData.reduce((sum, entry) => sum + entry.tasks, 0);
      const weeklyHours = weeklyData.reduce((sum, entry) => sum + entry.hours, 0);
      
      document.getElementById('thisWeekTasks').textContent = weeklyTasks;
      document.getElementById('thisWeekHours').textContent = weeklyHours.toFixed(1);
      
      // Calculate streak
      const streak = calculateStreak();
      document.getElementById('currentStreak').textContent = streak;
    }

    function calculateStreak() {
      if (progressData.length === 0) return 0;
      
      const sortedData = [...progressData].sort((a, b) => new Date(b.date) - new Date(a.date));
      let streak = 0;
      let currentDate = new Date();
      
      for (let entry of sortedData) {
        const entryDate = new Date(entry.date);
        const daysDiff = Math.floor((currentDate - entryDate) / (1000 * 60 * 60 * 24));
        
        if (daysDiff === streak) {
          streak++;
        } else if (daysDiff === streak + 1) {
          streak++;
        } else {
          break;
        }
      }
      
      return streak;
    }

    function formatDate(dateString) {
      const date = new Date(dateString);
      const options = { 
        weekday: 'long', 
        year: 'numeric', 
        month: 'long', 
        day: 'numeric' 
      };
      return date.toLocaleDateString('en-US', options);
    }

    // Initialize when page loads
    document.addEventListener('DOMContentLoaded', init);
  </script>
</body>
</html>